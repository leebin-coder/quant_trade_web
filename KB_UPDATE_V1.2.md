# 知识库功能更新 v1.2

## 新增功能

### 1. 知识库切换功能 🎯

**位置**: 顶部工具栏左侧

**功能描述**:
- 新增知识库选择下拉菜单
- 默认显示"系统知识库"
- 点击知识库名称或下拉箭头即可打开菜单
- 支持切换不同知识库(当前仅系统知识库可用)

**界面设计**:
```
┌────────────────────────────────┐
│ 📖 系统知识库 ▼ │ 当前页面标题 │
└────────────────────────────────┘
```

**下拉菜单选项**:
- ✅ 系统知识库 (默认选中,可用)
- 🔒 用户知识库(敬请期待) (禁用状态)

**交互效果**:
- 悬浮时背景变深
- 点击后箭头图标可以添加旋转动画
- 选中项高亮显示

### 2. 侧边栏折叠/展开功能 📂

**位置**: 左侧边栏右边缘中间

**功能描述**:
- 新增侧边栏折叠按钮(抽屉式)
- 点击可收起/展开左侧树状导航
- 收起后内容区域自动扩展
- 再次点击恢复侧边栏

**按钮设计**:
- 尺寸: 24px × 48px
- 位置: 侧边栏右边缘,垂直居中
- 形状: 右侧半圆形卡片
- 图标:
  - 展开状态: 「 (MenuFoldOutlined)
  - 收起状态: 」 (MenuUnfoldOutlined)

**视觉效果**:
- 白色背景,微妙阴影
- 悬浮时变蓝色,阴影加深
- 平滑的300ms过渡动画

**收起时变化**:
```
展开状态:              收起状态:
┌────┬──────┐         ┌──────────┐
│树  │      │         │          │
│状  │ 内容 │    →    │  内容    │
│结  │      │         │  (全屏)  │
│构  │      │         │          │
└────┴──────┘         └──────────┘
260px                  0px
```

### 3. 美化图标设计 ✨

#### 顶部工具栏图标
- **导出按钮** (新窗口打开):
  - 悬浮颜色: 绿色 (#34c759)
  - 背景: rgba(52, 199, 89, 0.08)

- **全屏按钮**:
  - 悬浮颜色: 蓝色 (#007aff)
  - 背景: rgba(0, 122, 255, 0.08)

- **关闭按钮**:
  - 悬浮颜色: 红色背景 (#ff3b30)
  - 文字: 白色

#### 侧边栏控制按钮
- 展开: ▣ (ExpandOutlined) - 蓝色
- 收起: ▢ (ShrinkOutlined) - 蓝色
- 定位: ⊙ (AimOutlined) - 蓝色

#### 树节点图标
- 大小: 13px (稍大一点)
- 颜色: #007aff (系统蓝)
- 默认透明度: 0.8
- 悬浮时: 透明度1.0 + 放大1.05倍
- 选中时: 透明度1.0,保持蓝色

## 界面布局更新

### 顶部工具栏 (40px)

```
┌──────────────────────────────────────────────────────┐
│ 📖系统知识库▼ │ 当前页面标题    [导出][全屏][关闭] │
└──────────────────────────────────────────────────────┘
     ↑             ↑                    ↑
  知识库选择    分割线+标题          三个按钮
```

### 主体区域

```
┌────────┬─────────────────────────────────┐
│ [▣▢⊙] │                                 │
├────────┤                                 │
│        │                                 │
│  树状  │           内容展示区            │
│  导航  「←折叠按钮                      │
│        │                                 │
│        │                                 │
└────────┴─────────────────────────────────┘
```

## 技术实现

### 新增状态管理
```jsx
const [currentKB, setCurrentKB] = useState('system')        // 当前知识库
const [sidebarCollapsed, setSidebarCollapsed] = useState(false) // 侧边栏折叠状态
```

### 新增组件
```jsx
// 知识库选择下拉菜单
<Dropdown menu={{ items: kbMenuItems, onClick: handleKBChange }}>
  <div className="kb-selector">
    <BookOutlined className="kb-icon" />
    <span className="kb-name">系统知识库</span>
    <DownOutlined className="kb-arrow" />
  </div>
</Dropdown>

// 侧边栏折叠按钮
<div className="sidebar-toggle" onClick={toggleSidebar}>
  {sidebarCollapsed ? <MenuUnfoldOutlined /> : <MenuFoldOutlined />}
</div>
```

### CSS关键样式
```css
/* 知识库选择器 */
.kb-selector {
  padding: 4px 10px;
  border-radius: 4px;
  background: rgba(0, 0, 0, 0.02);
}

/* 侧边栏折叠 */
.panel-sidebar {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.panel-sidebar.collapsed {
  width: 0;
  overflow: hidden;
}

/* 折叠按钮 */
.sidebar-toggle {
  position: absolute;
  right: -12px;
  top: 50%;
  width: 24px;
  height: 48px;
  border-radius: 0 6px 6px 0;
}
```

## 用户体验提升

### 1. 视觉识别性
- **彩色图标**: 不同功能用不同颜色,一目了然
- **悬浮反馈**: 所有可交互元素都有明确的悬浮状态
- **动画流畅**: 所有状态切换都有平滑过渡

### 2. 空间利用
- **可折叠侧边栏**: 需要更大阅读区域时可以隐藏侧边栏
- **智能布局**: 侧边栏折叠后,内容区自动占满空间

### 3. 功能扩展性
- **知识库切换**: 为未来添加自定义知识库预留接口
- **配置化设计**: 知识库列表可轻松扩展

## 配置说明

### 添加新知识库

编辑 `KnowledgeBasePanel.jsx`:

```jsx
const knowledgeBases = [
  {
    key: 'system',
    label: '系统知识库',
    icon: <BookOutlined />,
    config: knowledgeBaseConfig,
  },
  {
    key: 'custom',
    label: '我的知识库',
    icon: <BookOutlined />,
    config: customKnowledgeBaseConfig, // 你的配置
    disabled: false, // 设为false启用
  },
]
```

## 已知限制

1. **用户知识库**: 目前仅占位,功能未实现
2. **知识库切换**: 切换后会重置选中节点

## 后续计划

- [ ] 实现用户自定义知识库
- [ ] 支持知识库导入/导出
- [ ] 添加知识库搜索功能
- [ ] 支持收藏常用节点
- [ ] 添加阅读历史记录

---

**更新时间**: 2025-01-08
**版本**: v1.2
**兼容性**: 向下兼容 v1.0, v1.1

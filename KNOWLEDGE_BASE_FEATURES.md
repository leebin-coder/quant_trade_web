# 知识库功能使用指南

## 功能概览

知识库是一个采用macOS风格设计的内置文档系统,支持树状结构导航和网页内容嵌入展示。

## 如何打开知识库

点击顶部导航栏右侧的**书本图标** 📖 (位于用户头像左侧)即可打开知识库面板。

## 界面布局

知识库面板采用经典的左右分栏布局:

```
┌─────────────────────────────────────────────────────────┐
│  知识库标题                    [新窗口] [全屏] [关闭]  │ ← 顶部工具栏(40px高)
├─────────────┬───────────────────────────────────────────┤
│   目录      │                                           │
│  [展开]     │                                           │
│  [收起]     │                                           │
│  [定位]     │                                           │
├─────────────┤            内容展示区域                   │
│             │                                           │
│  📖 第一章  │         (iframe嵌入网页)                 │
│    └ 1.1    │                                           │
│    └ 1.2    │                                           │
│  📖 第二章  │                                           │
│             │                                           │
│  (树状导航) │                                           │
│             │                                           │
└─────────────┴───────────────────────────────────────────┘
    260px                   自适应宽度
```

## 主要功能

### 1. 树状导航 (左侧栏)

- **宽度**: 260px 固定宽度
- **背景**: 浅灰色(#fafafa),macOS风格
- **滚动条**: 3px细窄滚动条,半透明设计
- **默认状态**:
  - 自动打开第一层级
  - 自动选中第一个有URL的节点
  - 在右侧自动展示该节点内容

#### 树状导航控制按钮

位于左侧栏顶部,提供三个控制按钮:

- **[展开]** - 展开所有层级的树节点
- **[收起]** - 收起所有层级的树节点
- **[定位]** - 定位并高亮当前选中的节点
  - 自动展开到该节点的路径
  - 滚动到节点位置
  - 适合在深层级结构中快速找到当前位置

### 2. 内容展示区 (右侧)

- **方式**: 使用iframe嵌入网页
- **背景**: 纯白色
- **滚动**: 支持垂直滚动查看超长内容
- **滚动条**: 3px细窄滚动条

### 3. 顶部工具栏

工具栏高度仅40px,按钮尺寸28x28px,符合macOS精简设计:

#### 左侧
- **标题显示**: 当前选中节点的标题

#### 右侧按钮
1. **新窗口打开** (↗图标)
   - 在浏览器新标签页中打开当前内容
   - 未选中内容时禁用

2. **全屏切换** (⛶图标)
   - 点击切换全屏/正常模式
   - 全屏时占据整个浏览器窗口
   - 按ESC键快速退出全屏

3. **关闭** (×图标)
   - 关闭知识库面板
   - 悬浮时变为红色,提供视觉反馈

## 交互特性

### 节点选择
- 点击任意树节点,右侧立即展示对应网页内容
- 选中的节点会高亮显示(浅蓝色背景)
- 选中节点的标题字体会加粗

### 节点展开/收起
- 点击节点前的箭头图标展开/收起子节点
- 使用顶部的[展开]/[收起]按钮批量操作

### 定位当前节点
- 在深层级结构中浏览时,可能不清楚当前位置
- 点击[定位]按钮,树会自动:
  1. 展开到当前节点的完整路径
  2. 滚动到该节点位置
  3. 保持该节点的选中状态

## 样式特点

采用macOS Big Sur/Monterey的设计语言:

### 颜色
- 主背景: 纯白色 #ffffff
- 侧边栏背景: 浅灰 #fafafa
- 选中状态: 系统蓝 rgba(0, 122, 255, 0.12)
- 边框: 极细半透明边框 rgba(0, 0, 0, 0.06)
- 图标: 系统蓝 #007aff

### 字体
- 标题: 13px / 600粗细
- 树节点: 12px / 400粗细(选中时500)
- 按钮: 11px
- 行高: 1.4 确保良好可读性

### 圆角
- 面板: 12px
- 按钮: 4-6px
- 树节点: 5px

### 间距
- 紧凑设计,减少不必要的空白
- 树节点间距1px
- 缩进宽度16px

### 动画
- 所有交互都有流畅的过渡效果
- 使用 cubic-bezier(0.4, 0, 0.2, 1) 缓动函数
- 过渡时间150-200ms

### 滚动条
- 宽度: 3px (极细)
- 颜色: rgba(0, 0, 0, 0.08) 半透明
- 悬浮: rgba(0, 0, 0, 0.12) 稍深
- 轨道: 透明

## 尺寸规格

- **面板宽度**: 90vw (正常) / 100vw (全屏)
- **面板高度**: 90vh (正常) / 100vh (全屏)
- **顶部工具栏**: 40px
- **左侧导航栏**: 260px
- **导航栏顶部控制区**: 36px
- **按钮尺寸**: 28x28px (工具栏) / 24px高 (侧边栏)
- **图标大小**: 14px (工具栏) / 12px (树节点)

## 配置知识库内容

编辑 `src/config/knowledgeBase.js` 文件即可自定义知识库内容。

详细配置说明请参阅: [KNOWLEDGE_BASE_CONFIG.md](./KNOWLEDGE_BASE_CONFIG.md)

## 键盘快捷键

- **ESC** - 退出全屏模式

## 浏览器兼容性

- Chrome/Edge 90+
- Firefox 88+
- Safari 14+

主要依赖现代CSS特性:
- CSS Grid / Flexbox
- backdrop-filter (毛玻璃效果)
- CSS自定义滚动条

## 注意事项

1. **跨域限制**: 某些网站禁止在iframe中展示,会显示空白页面
2. **性能**: iframe会完整加载网页,建议配置轻量级文档页面
3. **移动端**: 在小屏幕设备上侧边栏宽度会自动缩小至220px

## 技术实现

- **框架**: React 18 + Ant Design 5
- **组件**:
  - `KnowledgeBasePanel.jsx` - 主面板容器
  - `KnowledgeBaseTree.jsx` - 树形导航组件
- **特性**:
  - forwardRef + useImperativeHandle 实现父子组件方法调用
  - 受控组件模式管理展开/选中状态
  - 递归算法处理树形数据结构

## 更新日志

### v1.0 (当前版本)
- ✅ 左右分栏布局,树状导航在左侧
- ✅ macOS风格精简设计
- ✅ 顶部工具栏40px,按钮28x28px
- ✅ 树状导航控制: 展开/收起/定位
- ✅ 默认打开第一个节点
- ✅ 3px细窄滚动条
- ✅ 流畅的动画过渡效果
- ✅ 支持全屏显示
- ✅ 支持新窗口打开
